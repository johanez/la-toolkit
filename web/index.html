<!DOCTYPE html>
<html>
  <head>
    <!--
         If you are serving your web app in a path other than the root, change the
         href value below to reflect the base path you are serving from.

         The path provided below has to start and end with a slash "/" in order for
         it to work correctly.

         Fore more details:
         * https://developer.mozilla.org/en-US/docs/Web/HTML/Element/base
    -->
    <base href="/" />

    <meta charset="UTF-8" />
    <meta content="IE=Edge" http-equiv="X-UA-Compatible" />
    <meta name="description" content="Living Atlases Toolkit" />

    <!-- iOS meta tags & icons -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="apple-mobile-web-app-title" content="la_toolkit" />
    <link rel="apple-touch-icon" href="icons/Icon-192.png" />

    <!-- Favicon -->
    <link href="./favicon.ico" rel="shortcut icon" type="image/x-icon" />

    <title>Living Atlases Toolkit</title>
    <link rel="stylesheet" type="text/css" href="styles.css" />
    <link rel="manifest" href="manifest.json" />
  </head>
  <body id="flutter_body">
    <!-- This script installs service_worker.js to provide PWA functionality to
         application. For more information, see:
         https://developers.google.com/web/fundamentals/primers/service-workers -->

    <div class="hero">
      <img src="img/la-toolkit-logo.png" class="splash-image center" />
      <div class="back-footer">
        Photo: Â©
        <a href="https://www.gbif.org/occurrence/2634416873">Martin Reith</a> CC
        BY-NC 4.0
      </div>
    </div>
    <!-- Other Body Properties -->

    <!-- Workaround https://github.com/flutter/flutter/issues/63500 -->
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', function () {
          //getting rid of undesired cache before running the app
          var seconds = new Date().getTime();
          xmlhttp = new XMLHttpRequest();
          xmlhttp.open('GET', '/version.txt?v=' + seconds, true);
          xmlhttp.onload = function () {
            if (xmlhttp.status == 200) {
              var buildNumber = xmlhttp.responseText.split('+')[1];
              var currentBuildNumber = window.localStorage.getItem(
                'buildNumber'
              );

              if (currentBuildNumber && currentBuildNumber != buildNumber) {
                caches.delete('flutter-app-manifest');
                caches.delete('flutter-temp-cache');
                caches.delete('flutter-app-cache');
              }

              window.localStorage.setItem('buildNumber', buildNumber);
            }
            navigator.serviceWorker.register('flutter_service_worker.js');
          };
          xmlhttp.error = function () {
            navigator.serviceWorker.register('flutter_service_worker.js');
          };
          xmlhttp.abort = function () {
            navigator.serviceWorker.register('flutter_service_worker.js');
          };
          xmlhttp.timeout = function () {
            navigator.serviceWorker.register('flutter_service_worker.js');
          };
          xmlhttp.send();
        });
      }
    </script>
    <script src="main.dart.js" type="application/javascript"></script>
  </body>
</html>
